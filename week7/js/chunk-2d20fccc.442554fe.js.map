{"version":3,"sources":["webpack:///./src/views/admin/Coupon.vue","webpack:///./src/components/CouponModal.vue","webpack:///./src/components/CouponModal.vue?80f5","webpack:///./src/views/admin/Coupon.vue?b215"],"names":["class","style","openModal","coupons","item","key","title","percent","$filters","date","due_date","is_enabled","openDeleteModal","pages","total_pages","current-page","currentPage","toPage","isNew","coupon","tempCoupon","ref","newOrUpdateCoupon","deleteCoupon","id","tabindex","aria-labelledby","aria-hidden","type","data-bs-dismiss","aria-label","for","placeholder","code","min","true-value","false-value","onUpdate","props","Object","default","Boolean","emits","data","bsModal","methods","this","show","hideModal","hide","$emit","watch","dueDate","Math","floor","Date","now","toISOString","split","shift","dateToTimestamp","mounted","$refs","modal","render","components","CouponModal","DeleteModal","Pagination","getCoupon","$swal","icon","toast","position","showConfirmButton","timer","hexAxios","get","page","then","res","success","isSuccess","pagination","couponModal","deleteModal","newCoupon","updateCoupon","put","src","post","new","delete","order","created"],"mappings":"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","file":"js/chunk-2d20fccc.442554fe.js","sourcesContent":["<template>\n  <div class=\"d-flex justify-content-between align-items-baseline\">\n    <h2><i class=\"bi bi-bag-check p-1\" style=\"font-size: 1.5rem;\"></i>優惠券</h2>\n    <button class=\"btn btn-primary m-3\" @click=\"openModal\">建立新的優惠券</button>\n  </div>\n  <table class=\"table mt-4\">\n    <thead>\n      <tr>\n        <th>名稱</th>\n        <th>折扣百分比</th>\n        <th>到期日</th>\n        <th>是否啟用</th>\n        <th>編輯</th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr v-for=\"(item, key) in coupons\" :key=\"key\">\n        <td>{{ item.title }}</td>\n        <td>{{ item.percent }}%</td>\n        <td>{{ $filters.date(item.due_date) }}</td>\n        <td>\n          <span v-if=\"item.is_enabled === 1\" class=\"text-success\">啟用</span>\n          <span v-else class=\"text-muted\">未啟用</span>\n        </td>\n        <td>\n          <div class=\"btn-group\">\n            <button class=\"btn btn-outline-primary btn-sm\" @click=\"openModal({ isNew: false, item })\">編輯</button>\n            <button class=\"btn btn-outline-danger btn-sm\" @click=\"openDeleteModal(item)\">刪除</button>\n          </div>\n        </td>\n      </tr>\n    </tbody>\n  </table>\n  <Pagination :pages=\"pages\" :current-page=\"currentPage\" @to-page=\"toPage\" v-if=\"pages.total_pages\"></Pagination>\n  <CouponModal\n    :isNew=\"isNew\"\n    :coupon=\"tempCoupon\"\n    ref=\"couponModal\"\n    @newOrUpdateCoupon=\"newOrUpdateCoupon\"\n  ></CouponModal>\n  <DeleteModal :item=\"tempCoupon\" @deletItem=\"deleteCoupon\" ref=\"deleteModal\"></DeleteModal>\n</template>\n<script>\nimport { hexAxios, api } from '@/response/hexAxios';\n\nimport CouponModal from '@/components/CouponModal.vue';\nimport DeleteModal from '@/components/DeleteModal.vue';\nimport Pagination from '@/components/Pagination.vue';\n\nexport default {\n  components: {\n    CouponModal,\n    DeleteModal,\n    Pagination,\n  },\n  data() {\n    return {\n      coupons: {},\n      tempCoupon: {\n        title: '',\n        is_enabled: 0,\n        percent: 100,\n        code: '',\n      },\n      isNew: false,\n      currentPage: 1,\n      pages: {},\n    };\n  },\n  methods: {\n    getCoupon() {\n      this.$swal({\n        title: '讀取優惠卷',\n        icon: 'info',\n        toast: true,\n        position: 'top',\n        showConfirmButton: false,\n        timer: 1000,\n      });\n      hexAxios.get(api.coupon.page(this.currentPage)).then((res) => {\n        const { success: isSuccess = false } = res.data;\n        if (isSuccess) {\n          const { coupons, pagination } = res.data;\n          this.coupons = coupons;\n          this.pages = { ...pagination };\n        }\n      });\n    },\n    toPage(page) {\n      this.currentPage = page;\n      this.getCoupon();\n    },\n    openModal({ isNew = true, item = {} } = {}) {\n      this.isNew = isNew;\n      this.tempCoupon = (isNew) ? {} : { ...item };\n      this.$refs.couponModal.openModal();\n    },\n    openDeleteModal(item) {\n      this.tempCoupon = { ...item };\n      this.$refs.deleteModal.openModal();\n    },\n    newOrUpdateCoupon(tempCoupon) {\n      const data = {\n        data: {\n          ...tempCoupon,\n        },\n      };\n      if (this.isNew) {\n        this.newCoupon(data);\n      } else {\n        this.updateCoupon(data);\n      }\n    },\n    updateCoupon(data) {\n      const { id } = data.data;\n      hexAxios.put(api.coupon.src(id), data).then((res) => {\n        const { success: isSuccess = false } = res.data;\n        if (isSuccess) {\n          this.getCoupon(this.currentPage);\n          this.$swal({\n            title: '更新優惠卷',\n            icon: 'success',\n            showConfirmButton: false,\n            timer: 1000,\n          });\n        }\n      });\n    },\n    newCoupon(data) {\n      hexAxios.post(api.coupon.new, data).then((res) => {\n        const { success: isSuccess = false } = res.data;\n        if (isSuccess) {\n          this.getCoupon();\n          this.$swal({\n            title: '已新增優惠卷',\n            icon: 'success',\n            showConfirmButton: false,\n            timer: 1000,\n          });\n        }\n      });\n    },\n    deleteCoupon() {\n      hexAxios.delete(api.order.src(this.tempCoupon.id)).then((res) => {\n        const { success: isSuccess = false } = res.data;\n        if (isSuccess) {\n          this.getCoupon(this.currentPage);\n          this.$swal({\n            title: '已刪除優惠卷',\n            icon: 'success',\n            showConfirmButton: false,\n            timer: 1000,\n          });\n        }\n      });\n    },\n  },\n  created() {\n    this.getCoupon();\n  },\n};\n</script>\n","<template>\n  <div\n    class=\"modal fade\"\n    id=\"couponModal\"\n    tabindex=\"-1\"\n    aria-labelledby=\"couponModalLabel\"\n    aria-hidden=\"true\"\n    ref=\"modal\"\n  >\n    <div class=\"modal-dialog modal-lg\">\n      <div class=\"modal-content\">\n        <div class=\"modal-header\">\n          <h5 class=\"modal-title\" id=\"couponModalLabel\">\n            <span v-if=\"isNew\">新增優惠卷</span>\n            <span v-else>編輯優惠卷</span>\n          </h5>\n          <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n        </div>\n        <div class=\"modal-body\">\n          <div class=\"mb-3\">\n            <label for=\"title\">標題</label>\n            <input type=\"text\" class=\"form-control\" id=\"title\" v-model=\"tempCoupon.title\" placeholder=\"請輸入標題\" />\n          </div>\n          <div class=\"mb-3\">\n            <label for=\"coupon_code\">優惠碼</label>\n            <input\n              type=\"text\"\n              class=\"form-control\"\n              id=\"coupon_code\"\n              v-model=\"tempCoupon.code\"\n              placeholder=\"請輸入優惠碼\"\n            />\n          </div>\n          <div class=\"mb-3\">\n            <label for=\"due_date\">到期日</label>\n            <input type=\"date\" class=\"form-control\" id=\"due_date\" v-model=\"due_date\" />\n          </div>\n          <div class=\"mb-3\">\n            <label for=\"price\">折扣百分比</label>\n            <input\n              type=\"number\"\n              class=\"form-control\"\n              id=\"price\"\n              min=\"0\"\n              v-model.number=\"tempCoupon.percent\"\n              placeholder=\"請輸入折扣百分比\"\n            />\n          </div>\n          <div class=\"mb-3\">\n            <div class=\"form-check\">\n              <input\n                class=\"form-check-input\"\n                type=\"checkbox\"\n                :true-value=\"1\"\n                :false-value=\"0\"\n                v-model=\"tempCoupon.is_enabled\"\n                id=\"is_enabled\"\n              />\n              <label class=\"form-check-label\" for=\"is_enabled\">\n                是否啟用\n              </label>\n            </div>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">取消</button>\n          <button type=\"button\" class=\"btn btn-primary\" @click=\"onUpdate\">更新優惠券</button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport { Modal } from 'bootstrap';\n\nexport default {\n  props: {\n    coupon: {\n      type: Object,\n      default() {\n        return {};\n      },\n    },\n    isNew: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  emits: ['newOrUpdateCoupon'],\n  data() {\n    return {\n      bsModal: '',\n      tempCoupon: {},\n      due_date: '',\n    };\n  },\n  methods: {\n    openModal() {\n      this.bsModal.show();\n    },\n    hideModal() {\n      this.bsModal.hide();\n    },\n    onUpdate() {\n      this.$emit('newOrUpdateCoupon', this.tempCoupon);\n      this.hideModal();\n    },\n  },\n  watch: {\n    coupon() {\n      this.tempCoupon = {\n        ...this.coupon,\n      };\n      const dueDate = this.tempCoupon.due_date || Math.floor(Date.now() / 1000);\n      const date = new Date(dueDate * 1000).toISOString().split('T');\n      this.due_date = date.shift();\n    },\n    due_date() {\n      this.tempCoupon.due_date = this.$filters.dateToTimestamp(this.due_date);\n    },\n  },\n  mounted() {\n    this.bsModal = new Modal(this.$refs.modal);\n  },\n};\n</script>\n","import { render } from \"./CouponModal.vue?vue&type=template&id=59613ebe\"\nimport script from \"./CouponModal.vue?vue&type=script&lang=js\"\nexport * from \"./CouponModal.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","import { render } from \"./Coupon.vue?vue&type=template&id=63d11d9c\"\nimport script from \"./Coupon.vue?vue&type=script&lang=js\"\nexport * from \"./Coupon.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}