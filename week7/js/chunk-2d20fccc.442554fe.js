(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d20fccc"],{b4bf:function(e,t,o){"use strict";o.r(t);var n=o("7a23"),a={class:"d-flex justify-content-between align-items-baseline"},c=Object(n["h"])("h2",null,[Object(n["h"])("i",{class:"bi bi-bag-check p-1",style:{"font-size":"1.5rem"}}),Object(n["g"])("優惠券")],-1),l={class:"table mt-4"},u=Object(n["h"])("thead",null,[Object(n["h"])("tr",null,[Object(n["h"])("th",null,"名稱"),Object(n["h"])("th",null,"折扣百分比"),Object(n["h"])("th",null,"到期日"),Object(n["h"])("th",null,"是否啟用"),Object(n["h"])("th",null,"編輯")])],-1),s={key:0,class:"text-success"},i={key:1,class:"text-muted"},d={class:"btn-group"};function p(e,t,o,p,b,r){var h=Object(n["C"])("Pagination"),O=Object(n["C"])("CouponModal"),j=Object(n["C"])("DeleteModal");return Object(n["u"])(),Object(n["d"])(n["a"],null,[Object(n["h"])("div",a,[c,Object(n["h"])("button",{class:"btn btn-primary m-3",onClick:t[1]||(t[1]=function(){return r.openModal&&r.openModal.apply(r,arguments)})},"建立新的優惠券")]),Object(n["h"])("table",l,[u,Object(n["h"])("tbody",null,[(Object(n["u"])(!0),Object(n["d"])(n["a"],null,Object(n["A"])(b.coupons,(function(t,o){return Object(n["u"])(),Object(n["d"])("tr",{key:o},[Object(n["h"])("td",null,Object(n["F"])(t.title),1),Object(n["h"])("td",null,Object(n["F"])(t.percent)+"%",1),Object(n["h"])("td",null,Object(n["F"])(e.$filters.date(t.due_date)),1),Object(n["h"])("td",null,[1===t.is_enabled?(Object(n["u"])(),Object(n["d"])("span",s,"啟用")):(Object(n["u"])(),Object(n["d"])("span",i,"未啟用"))]),Object(n["h"])("td",null,[Object(n["h"])("div",d,[Object(n["h"])("button",{class:"btn btn-outline-primary btn-sm",onClick:function(e){return r.openModal({isNew:!1,item:t})}},"編輯",8,["onClick"]),Object(n["h"])("button",{class:"btn btn-outline-danger btn-sm",onClick:function(e){return r.openDeleteModal(t)}},"刪除",8,["onClick"])])])])})),128))])]),b.pages.total_pages?(Object(n["u"])(),Object(n["d"])(h,{key:0,pages:b.pages,"current-page":b.currentPage,onToPage:r.toPage},null,8,["pages","current-page","onToPage"])):Object(n["e"])("",!0),Object(n["h"])(O,{isNew:b.isNew,coupon:b.tempCoupon,ref:"couponModal",onNewOrUpdateCoupon:r.newOrUpdateCoupon},null,8,["isNew","coupon","onNewOrUpdateCoupon"]),Object(n["h"])(j,{item:b.tempCoupon,onDeletItem:r.deleteCoupon,ref:"deleteModal"},null,8,["item","onDeletItem"])],64)}var b=o("5530"),r=o("9de5"),h={class:"modal fade",id:"couponModal",tabindex:"-1","aria-labelledby":"couponModalLabel","aria-hidden":"true",ref:"modal"},O={class:"modal-dialog modal-lg"},j={class:"modal-content"},m={class:"modal-header"},f={class:"modal-title",id:"couponModalLabel"},C={key:0},v={key:1},g=Object(n["h"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),w={class:"modal-body"},y={class:"mb-3"},M=Object(n["h"])("label",{for:"title"},"標題",-1),k={class:"mb-3"},_=Object(n["h"])("label",{for:"coupon_code"},"優惠碼",-1),U={class:"mb-3"},N=Object(n["h"])("label",{for:"due_date"},"到期日",-1),P={class:"mb-3"},$=Object(n["h"])("label",{for:"price"},"折扣百分比",-1),D={class:"mb-3"},x={class:"form-check"},J=Object(n["h"])("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),B={class:"modal-footer"},T=Object(n["h"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function V(e,t,o,a,c,l){return Object(n["u"])(),Object(n["d"])("div",h,[Object(n["h"])("div",O,[Object(n["h"])("div",j,[Object(n["h"])("div",m,[Object(n["h"])("h5",f,[o.isNew?(Object(n["u"])(),Object(n["d"])("span",C,"新增優惠卷")):(Object(n["u"])(),Object(n["d"])("span",v,"編輯優惠卷"))]),g]),Object(n["h"])("div",w,[Object(n["h"])("div",y,[M,Object(n["O"])(Object(n["h"])("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[1]||(t[1]=function(e){return c.tempCoupon.title=e}),placeholder:"請輸入標題"},null,512),[[n["J"],c.tempCoupon.title]])]),Object(n["h"])("div",k,[_,Object(n["O"])(Object(n["h"])("input",{type:"text",class:"form-control",id:"coupon_code","onUpdate:modelValue":t[2]||(t[2]=function(e){return c.tempCoupon.code=e}),placeholder:"請輸入優惠碼"},null,512),[[n["J"],c.tempCoupon.code]])]),Object(n["h"])("div",U,[N,Object(n["O"])(Object(n["h"])("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[3]||(t[3]=function(e){return c.due_date=e})},null,512),[[n["J"],c.due_date]])]),Object(n["h"])("div",P,[$,Object(n["O"])(Object(n["h"])("input",{type:"number",class:"form-control",id:"price",min:"0","onUpdate:modelValue":t[4]||(t[4]=function(e){return c.tempCoupon.percent=e}),placeholder:"請輸入折扣百分比"},null,512),[[n["J"],c.tempCoupon.percent,void 0,{number:!0}]])]),Object(n["h"])("div",D,[Object(n["h"])("div",x,[Object(n["O"])(Object(n["h"])("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":t[5]||(t[5]=function(e){return c.tempCoupon.is_enabled=e}),id:"is_enabled"},null,512),[[n["I"],c.tempCoupon.is_enabled]]),J])])]),Object(n["h"])("div",B,[T,Object(n["h"])("button",{type:"button",class:"btn btn-primary",onClick:t[6]||(t[6]=function(){return l.onUpdate&&l.onUpdate.apply(l,arguments)})},"更新優惠券")])])])],512)}o("ac1f"),o("1276");var I=o("7b17"),F={props:{coupon:{type:Object,default:function(){return{}}},isNew:{type:Boolean,default:!1}},emits:["newOrUpdateCoupon"],data:function(){return{bsModal:"",tempCoupon:{},due_date:""}},methods:{openModal:function(){this.bsModal.show()},hideModal:function(){this.bsModal.hide()},onUpdate:function(){this.$emit("newOrUpdateCoupon",this.tempCoupon),this.hideModal()}},watch:{coupon:function(){this.tempCoupon=Object(b["a"])({},this.coupon);var e=this.tempCoupon.due_date||Math.floor(Date.now()/1e3),t=new Date(1e3*e).toISOString().split("T");this.due_date=t.shift()},due_date:function(){this.tempCoupon.due_date=this.$filters.dateToTimestamp(this.due_date)}},mounted:function(){this.bsModal=new I["a"](this.$refs.modal)}};F.render=V;var L=F,S=o("ec05"),z=o("1799"),A={components:{CouponModal:L,DeleteModal:S["a"],Pagination:z["a"]},data:function(){return{coupons:{},tempCoupon:{title:"",is_enabled:0,percent:100,code:""},isNew:!1,currentPage:1,pages:{}}},methods:{getCoupon:function(){var e=this;this.$swal({title:"讀取優惠卷",icon:"info",toast:!0,position:"top",showConfirmButton:!1,timer:1e3}),r["b"].get(r["a"].coupon.page(this.currentPage)).then((function(t){var o=t.data.success,n=void 0!==o&&o;if(n){var a=t.data,c=a.coupons,l=a.pagination;e.coupons=c,e.pages=Object(b["a"])({},l)}}))},toPage:function(e){this.currentPage=e,this.getCoupon()},openModal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.isNew,o=void 0===t||t,n=e.item,a=void 0===n?{}:n;this.isNew=o,this.tempCoupon=o?{}:Object(b["a"])({},a),this.$refs.couponModal.openModal()},openDeleteModal:function(e){this.tempCoupon=Object(b["a"])({},e),this.$refs.deleteModal.openModal()},newOrUpdateCoupon:function(e){var t={data:Object(b["a"])({},e)};this.isNew?this.newCoupon(t):this.updateCoupon(t)},updateCoupon:function(e){var t=this,o=e.data.id;r["b"].put(r["a"].coupon.src(o),e).then((function(e){var o=e.data.success,n=void 0!==o&&o;n&&(t.getCoupon(t.currentPage),t.$swal({title:"更新優惠卷",icon:"success",showConfirmButton:!1,timer:1e3}))}))},newCoupon:function(e){var t=this;r["b"].post(r["a"].coupon.new,e).then((function(e){var o=e.data.success,n=void 0!==o&&o;n&&(t.getCoupon(),t.$swal({title:"已新增優惠卷",icon:"success",showConfirmButton:!1,timer:1e3}))}))},deleteCoupon:function(){var e=this;r["b"].delete(r["a"].order.src(this.tempCoupon.id)).then((function(t){var o=t.data.success,n=void 0!==o&&o;n&&(e.getCoupon(e.currentPage),e.$swal({title:"已刪除優惠卷",icon:"success",showConfirmButton:!1,timer:1e3}))}))}},created:function(){this.getCoupon()}};A.render=p;t["default"]=A}}]);
//# sourceMappingURL=chunk-2d20fccc.442554fe.js.map